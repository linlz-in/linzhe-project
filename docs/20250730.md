#### 20250730 工作日报
* 1.商品主题 商品诊断看板 任务工单(对0729日的工单进行优化)
     在进行模拟数据时，对初始数据进行了简单的运算，从而给后面的数据减少了运算成本
  全品价值评估支持基于三种维度（评分-金额/价格-销量/访客-销量）的分析
  店铺商品分布，聚焦核心商品和潜力商品进行运营
  * 商品的基础信息
    product_id(商品ID),product_name(商品名称),category(商品分类),price(价格),visit_count(访客数（流量）),
    conversion_rate(转化率),sales_volume(销量),score(评分),content_engagement(内容互动量),
    new_user_count(拉新数),service_rating(服务评分),data_date()
  * dwd层 数据清洗与转换
    对基础数据进行增加字段 score_level 对评分进行处理
  * dws层 聚合计算每个维度指标
    1.1 全品价值评估
       求出每个商品维度的评分-金额/价格-销量/访客-销量 
        评分-金额 = 评分 * 金额 （主要反映了商品在销售金额上的贡献值，可以让商家更直观地了解商品带来的价值）
        价格-销量 = 价格 / 销量 （单位销量对应的价格，可以反映商品价格对销量的影响）
        访客-销量 = 访客数 / 销量 （单位销量所需的访客数，可以反映商品价格对访客数的影响）
             select
             product_id,
             product_name,
             category,
             score_level,
             price * sales_volume as total_amount,
             price / sales_volume as price_sales_ratio,
             visit_count / sales_volume as visit_sales_ratio
             from dwd_product_clean
    1.2 单品竞争力诊断  
      求出计算同类商品的平均值
          select
          category,
          avg(visit_count) as avg_visit,
          avg(conversion_rate) as avg_conversion,
          avg(content_engagement) as avg_content,
          avg(new_user_count) as avg_new_user,
          avg(service_rating) as avg_service
          from dwd_product_clean
          group by category
  * ads层 看板数据
    1.1 全品价值评估
        标记核心商品（A级 总金额前20%） 潜力商品（B级 销量增长快）
        通过计算分位数 percentile 判断是否为核心商品 和 潜力商品  并打一个标签
            select
            a.*,
            case when a.score_level = 'A级' and a.total_amount >= b.p80 then '核心商品'
            when a.score_level = 'B级' and a.visit_sales_ration < b.avg_ratio then '潜力商品'
            else '一般商品' end as value_tag
            from dws_comprehensive_product a
            join (
            select
            percentile(cast(total_amount * 100 as bigint), 0.8) / 100 as p80,
            avg(visit_sales_ration) as avg_ratio
            from dws_comprehensive_product
            ) b
    1.2 单品竞争力诊断
        针对五个维度进行对比
            流量获取 ，流量转换 ，服务质量 ，客户拉新 ，内容营销
            用本品/同类平均进行比例
               create table if not exists ads_product_competitor_dimension (
               product_id string,
               product_name string,
               traffic_index double,  -- 流量获取 （本品/同类平均）
               conversion_index double, -- 流量转换
               service_index double, -- 服务质量
               content_index double,  --客户拉新
               new_user_index double  -- 内容营销
               )stored as parquet
                 
               insert overwrite table ads_product_competitor_dimension
               select
               a.product_id,
               a.product_name,
               a.visit_count / b.avg_visit as traffic_index,
               a.conversion_rate / b.avg_conversion as conversion_index,
               a.service_rating / b.avg_service as service_index,
               a.content_engagement / b.avg_content as content_index,
               a.new_user_count / b.avg_new_user as new_user_index
               from dwd_product_clean a
               join dws_category_avg b
               ON a.category = b.category

    1.3 单品竞争力构成表 
        对权重值进行计算
        将 流量，转换，服务，拉新，内容 分别乘以权重值 最后进行求和
              select
              product_id,
              product_name,
              traffic_index * 0.3 as traffic_weight,
              conversion_index * 0.25 as conversion_weight,
              service_index * 0.15 as service_weight,
              new_user_index * 0.15 as new_user_weight,
              content_index * 0.15 as content_weight,
              (traffic_index * 0.3 + conversion_index * 0.25 +
              service_index * 0.15 + new_user_index * 0.15 +
              content_index * 0.15) as total_score
              from ads_product_competitor_dimension
          


			
		
		
			
			